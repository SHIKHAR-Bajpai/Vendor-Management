    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ShopFinder - Find Local Shops Near You</title>
        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <!-- Custom CSS -->
        <style>
            .hero-section {
                padding: 4rem 0;
                background-color: #f8f9fa;
            }
            .shop-card {
                transition: transform 0.3s;
                height: 100%;
            }
            .shop-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            }
            .footer {
                margin-top: 3rem;
                padding: 2rem 0;
                background-color: #343a40;
                color: white;
            }
            #map {
                height: 400px;
                width: 100%;
                border-radius: 8px;
            }
        </style>
    </head>
    <body>
        <!-- Navigation -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="/">ShopFinder</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="/">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/" id="findShopsBtn" role="button">Find Shops</a>
                        </li>
                    </ul>
                    <ul class="navbar-nav">
                        <li class="nav-item" id="loginNav">
                            <a class="nav-link" href="/login">Login</a>
                        </li>
                        <li class="nav-item" id="registerNav">
                            <a class="nav-link" href="/register">Register</a>
                        </li>
                        <li class="nav-item d-none" id="dashboardNav">
                            <a class="nav-link" href="/dashboard">Dashboard</a>
                        </li>
                        <li class="nav-item d-none" id="logoutNav">
                            <a class="nav-link" href="/" id="logoutBtn">Logout</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <section class="hero-section">
            <div class="container text-center">
                <h1 class="display-4">Find Local Shops Near You</h1>
                <p class="lead">Discover nearby businesses with just one click</p>
                <button class="btn btn-primary btn-lg" id="locateBtn" onclick="findShops()">Find Nearby Shops</button>
            </div>
        </section>

        <!-- Map Section -->
        <section class="container my-5">
            <div class="row">
                <div class="col-md-12">
                    <div id="map" class="shadow d-none"></div>
                </div>
            </div>
        </section>

        <!-- Shops Section -->
        <section class="container my-5">
            <h2 class="text-center mb-4">Nearby Shops</h2>
            <div class="row" id="shopsContainer">
                <!-- Shops will be displayed here -->
                <div class="col-12 text-center" id="initialMessage">
                    <p>Click "Find Nearby Shops" to discover businesses around you</p>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="container text-center">
                <p>Â© 2025 ShopFinder. All rights reserved.</p>
            </div>
        </footer>

        <!-- Bootstrap Bundle with Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        
        <!-- App Scripts -->
        <script src="/app/templates/auth.js"></script>
        
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                // Check authentication status
                checkAuthStatus();
                
                // Get DOM elements
                const locateBtn = document.getElementById('locateBtn');
                const findShopsBtn = document.getElementById('findShopsBtn');
                const shopsContainer = document.getElementById('shopsContainer');
                const initialMessage = document.getElementById('initialMessage');
                const mapElement = document.getElementById('map');
                
                locateBtn.addEventListener('click', getLocation);
                findShopsBtn.addEventListener('click', getLocation);
                
                // Function to find nearby shops

                function findShops() {
                    if (navigator.geolocation) {
                        navigator.geolocation.getCurrentPosition(async (position) => {
                            const { latitude, longitude } = position.coords;
                            try {
                                const response = await fetch(`/shops/nearby?latitude=${latitude}&longitude=${longitude}`);
                                const shops = await response.json();
                                displayShops(shops);
                            } catch (error) {
                                console.error("Error fetching shops:", error);
                                document.getElementById("shops").innerHTML = "<p class='text-danger'>Failed to load shops.</p>";
                            }
                        }, (error) => {
                            console.error("Geolocation error:", error);
                            document.getElementById("shops").innerHTML = "<p class='text-danger'>Location access denied.</p>";
                        });
                    } else {
                        document.getElementById("shops").innerHTML = "<p class='text-danger'>Geolocation is not supported.</p>";
                    }
                }

                function displayShops(shops) {
                    let html = "<h2>Nearby Shops</h2><ul class='list-group mt-3'>";
                    if (shops.length === 0) {
                        html += "<li class='list-group-item'>No shops found nearby.</li>";
                    } else {
                        shops.forEach(shop => {
                            html += `<li class='list-group-item'><strong>${shop.name}</strong><br> ${shop.address}</li>`;
                        });
                    }
                    html += "</ul>";
                    document.getElementById("shops").innerHTML = html;
                }
            })


                // function displayShops(shops, userLat, userLng) {
                // shopsContainer.innerHTML = '';

            //     if (shops.length === 0) {
            //         shopsContainer.innerHTML = `<div class="col-12 text-center"><p>No shops found in your area. Try increasing the search radius.</p></div>`;
            //         return;
            //     }

            //     shops.forEach(shop => {
            //         const distance = calculateDistance(userLat, userLng, shop.latitude, shop.longitude);
            //         const shopCard = document.createElement('div');
            //         shopCard.className = 'col-md-4 mb-4';
            //         shopCard.innerHTML = `
            //             <div class="card shop-card shadow-sm">
            //                 <div class="card-body">
            //                     <h5 class="card-title">${shop.shop_name}</h5>
            //                     <h6 class="card-subtitle mb-2 text-muted">${shop.type}</h6>
            //                     <p class="card-text">Owner: ${shop.owner_name}</p>
            //                     <p class="card-text"><small class="text-muted">Approximately ${distance.toFixed(1)} km away</small></p>
            //                 </div>
            //             </div>
            //         `;
            //         shopsContainer.appendChild(shopCard);
            //     });
            // }

            function checkAuthStatus() {
                // Simulating authentication check - Replace this with actual authentication logic
                const isAuthenticated = localStorage.getItem("isAuthenticated"); // Use actual auth check
        
                const loginNav = document.getElementById("loginNav");
                const registerNav = document.getElementById("registerNav");
                const dashboardNav = document.getElementById("dashboardNav");
                const profileNav = document.getElementById("profileNav");
                const logoutNav = document.getElementById("logoutNav");
        
                if (isAuthenticated) {
                    loginNav.classList.add("d-none");
                    registerNav.classList.add("d-none");
                    dashboardNav.classList.remove("d-none");
                    profileNav.classList.remove("d-none");
                    logoutNav.classList.remove("d-none");
                } else {
                    loginNav.classList.remove("d-none");
                    registerNav.classList.remove("d-none");
                    dashboardNav.classList.add("d-none");
                    profileNav.classList.add("d-none");
                    logoutNav.classList.add("d-none");
                }
            }
        
            document.getElementById("logoutBtn").addEventListener("click", function () {
                localStorage.removeItem("isAuthenticated"); // Replace with actual logout logic
                checkAuthStatus();
                window.location.href = "/"; // Redirect to home after logout
            });

        </script>
    </body>
    </html> 
